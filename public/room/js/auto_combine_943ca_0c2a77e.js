dwfis.define("layer",function(){var t={centerOnScreen:function(t){var i=($(window),document.documentElement,Math.floor(($(window).width()-t.width())/2)),s=Math.floor(($(window).height()-t.height())/2);t.css({left:i+"px",top:s+"px"})},Mask:{mask:null,show:function(){return this.mask||(this.mask=$("<div id='mask'></div>")),"none"===this.mask.css("display")?this.mask.show():$("body").append(this.mask),this},hide:function(){return this.mask.hide(),this},destory:function(t){this.mask.remove(),t&&(this.mask=null)}},PopupBox:{popupBox:null,setting:{isDefault:!1,content:"",existMask:!0},createBox:function(){var t=$("<div class='popup-box'></div>");t.hide().appendTo($("body")),this.popupBox=t},show:function(i){$.extend(this.setting,i,!0),this.popupBox||this.createBox();var s=this.popupBox;if(this.setting.isDefault){var o="<h3 class='popup-box-title'>\u6e29\u99a8\u63d0\u793a</h3><a href='#' class='popup-box-close-btn close' title='\u5173\u95ed'>\u5173\u95ed</a>";o+="<div class='popup-box-content'>",o+=this.setting.content,o+="</div>",s.html(o)}else s.html("").append(this.setting.content);var e="<iframe style='width:";e+=s.width()+"px; height:"+s.height(),e+="px; position:absolute; left:0; top:0; z-index:-1; background-color:#000;filter: alpha(opacity=0);opacity: 0;'></iframe>",s.prepend(e),s.find(".js-close").click(function(){return t.PopupBox.close(),!1}),t.centerOnScreen(s),this.setting.existMask&&t.Mask.show(),s.show().focus()},close:function(){this.popupBox&&(this.popupBox.hide(),this.setting.existMask&&t.Mask.hide())},destory:function(){this.close(),this.popupBox.remove(),this.popupBox=null}}};return t});
;dwfis.define("widget/room-youlike/room-youlike.js",function(){$("#youlike-list").find("img").lazyload({container:$("#main_col"),threshold:200})});
;dwfis.define("widget/room-video/room-video.js",function(require,exports,module){var godLens={init:function(){this.getlistbyuid()},getlistbyuid:function(){var $huyaVideo=$("#huya-video"),tmpl="";$huyaVideo.length>0&&window.l_p&&$.getJSON("http://v.huya.com/index.php?callback=?",{r:"api/getlistbyuid",uid:l_p},function(json){json&&json.length>0?(tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var data,i=0,len=aData.length;len>i;i++)data=aData[i],__p+='\r\n<li class="game-live-item">\r\n    <a href="'+(null==(__t=data.video_url)?"":__t)+'" class="video-info clickstat" target="_blank" eid="click/zhibo/tjwz/video'+(null==(__t=i+1)?"":__t)+'" eid_desc="\u70b9\u51fb/\u76f4\u64ad\u95f4/\u63a8\u8350\u4f4d\u7f6e/\u89c6\u9891'+(null==(__t=i+1)?"":__t)+'">\r\n        <img class="pic" data-original="'+(null==(__t=data.video_cover)?"":__t)+'" alt="'+(null==(__t=data.video_title)?"":__t)+'" src="http://assets.dwstatic.com/amkit/p/duya/common/img/default_live.jpg">\r\n        <span class="video_duration">'+(null==(__t=data.video_duration)?"":__t)+'</span>\r\n        <div class="item-mask"></div>\r\n        <i class="btn-play__hover"></i>\r\n        ',data.rank&&(__p+='\r\n        <em class="tag tag-recommend">\r\n            ',data.rank.indexOf("NO.")>-1&&(__p+="\r\n            <span></span>\r\n            "),__p+="\r\n            "+(null==(__t=data.rank)?"":__t)+"\r\n        </em>\r\n        "),__p+='\r\n    </a>\r\n    <div class="all_live_tit">\r\n    	<a href="'+(null==(__t=data.video_url)?"":__t)+'" class="title clickstat" target="_blank" id="click/zhibo/tjwz/video'+(null==(__t=i+1)?"":__t)+'" eid_desc="\u70b9\u51fb/\u76f4\u64ad\u95f4/\u63a8\u8350\u4f4d\u7f6e/\u89c6\u9891'+(null==(__t=i+1)?"":__t)+'">'+(null==(__t=data.video_title)?"":__t)+'</a>\r\n    </div>\r\n    <div class="txt">\r\n	    <span class="avatar fl">\r\n	        <img alt="'+(null==(__t=data.video_title)?"":__t)+'" data-original="'+(null==(__t=data.user_avatar)?"":__t)+'" src="http://assets.dwstatic.com/amkit/p/duya/common/img/default_profile.jpg"> \r\n	    	<i class="nick" title="'+(null==(__t=data.user_nickname)?"":_.escape(__t))+'"> '+(null==(__t=data.user_nickname)?"":_.escape(__t))+'</i>\r\n	    </span>\r\n        <span class="num"><i class="num-icon"></i><i class="js-num">'+(null==(__t=data.video_play_num)?"":__t)+"</i></span>\r\n    </div>\r\n</li>\r\n";__p+="\r\n"}return __p},$huyaVideo.html(tmpl({aData:json.slice(0,6)})),$("#huya-video").find("img").lazyload({container:$("#main_col")})):$(".huya-video").remove()})}};godLens.init()});
;dwfis.define("respondCard",function(t,e,i){function n(){this.initialize.apply(this,arguments)}n.prototype={initialize:function(t){this.$wrapElement=$(t.wrapElement),this.$itemElement=this.$wrapElement.find(t.itemElement),this.itemWidth=this.$itemElement.outerWidth(),this.createCsstext=t.createCsstext,this.iMargin=this.$itemElement.outerWidth(!0)-this.itemWidth,this.scale=t.scale,this.calculation(),this.bindEvent()},_importStyle:function(t,e){if(!document.getElementById(e)){var i=document.createElement("style");if(e&&(i.id=e),document.getElementsByTagName("head")[0].appendChild(i),i.styleSheet){if(document.getElementsByTagName("style").length>31)throw new Error("Exceed the maximal count of style tags in IE");i.styleSheet.cssText=t}else i.innerHTML=t}},calculation:function(){var t=this.$wrapElement.innerWidth(),e=Math.floor(t/(this.itemWidth+this.iMargin)),i=Math.floor(t/e)-this.iMargin,n=Math.floor(i/this.scale),s=this.createCsstext(i,n),l=document.getElementById("respondStyle");l?l.styleSheet?l.styleSheet.cssText=s:l.innerHTML=s:this._importStyle(s,"respondStyle")},bindEvent:function(){var t=this;$(window).on("resize.responseCard",function(){t.calculation()})}},i.exports=n});
;dwfis.define("app/room_main",function(t){function e(){var t=$("#J_spbg");if(t.length){var e=t.width(),i=520/1920,o=e*i;t.css("marginBottom",.4*-o),t.height(o)}}function i(){if($(".on-special").length>0&&0==$(".on-match").length){var t=$(".room-wrap").offset().top-$("#duya-header").outerHeight()-10;$("#main_col").stop(!0).animate({scrollTop:t},1e3,"easeOutQuint")}}t("room_common"),function(){function t(t,e,i){t=t||"",e=e||function(){},i=i||function(){};var o=new Image;o.readyState?o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&(o.onreadystatechange=null,e(o))}:o.onload=function(){e(o)},o.onerror=function(){i(o)},o.src=t}var e=TT.app.main+"cache10min.php?m=Ad&do=ajaxGetAds&type=4&area=27&num=1";$.ajax({url:e,dataType:"json",cache:!0}).done(function(e){if(1e3==e.status){if(e.data&&e.data.length){var i=e.data[0];i&&t(i.picUrl,function(){var t=$('<a class="room-hd-a-d" href="'+i.link+'" title="'+i.title+'" target="_blank"><img src="'+i.picUrl+'" alt="'+i.title+'" /></a>');$(".host-control").prepend(t),t.on("click",function(){try{ya.reportProductEvent({eid:"click/zhibo/topggpic",eid_desc:"\u70b9\u51fb/\u76f4\u64ad\u95f4/\u9876\u90e8\u63a8\u5e7f\u56fe"})}catch(t){}})})}}else TT.log("\u83b7\u53d6\u76f4\u64ad\u95f4\u5934\u90e8\u5e7f\u544a\u6570\u636e\u5931\u8d25\uff1a"+e.msg)}).fail(function(t,e){TT.log("\u83b7\u53d6\u76f4\u64ad\u95f4\u5934\u90e8\u5e7f\u544a\u6570\u636e\u5931\u8d25\uff1a"+e)})}();var o=$(".chat-room__hd").find(".current").attr("tab_index");t("widget/room-youlike/room-youlike.js"),t("widget/room-video/room-video.js");var n=t("respondCard"),a=new n({wrapElement:".recom-list",itemElement:".game-live-item",scale:280/158,createCsstext:function(t,e){var i=".recom-list .game-live-item {width:"+t+"px!important;}";return i+=".recom-list {height:"+(e+70)+"px!important;}",i+=".recom-list .video-info {height:"+e+"px!important;}"}});DUYA_SUB.subscribe("sidebarShow",function(){a.calculation()}),DUYA_SUB.subscribe("sidebarHide",function(){a.calculation()}),$.extend($.easing,{easeOutQuint:function(t,e,i,o,n){return o*((e=e/n-1)*e*e*e*e+1)+i}}),DUYA_SUB.subscribe("resizeWide",function(){e()}),e(),DUYA_SUB.subscribe("resizeSidebar",function(){i()}),i(),function(){var t=$("#J_mainRoom"),e=function(){t.width()<=1150?t.addClass("main-room-small"):t.removeClass("main-room-small")};e(),TT.on("resizeWide",HUYA_UTIL.debounce(e,30))}();var r=function(){var t=$(window),e=9/16,i=$(".room-player-wrap"),n=$(".chat-room__panel"),a=$("#J_playerMain"),r=$(".chat-room__other"),c=$(".room-sidebar"),s=$(".room-hd").outerHeight(!0),h=$("#duya-header").height(),d=$("#tipsOrchat"),l=100,m=$(".week-rank").length>0?130:0;return"undefined"!=typeof REPLAY&&1==REPLAY&&(l=40),function(){var u=parseInt(a.width()*e)+l,f=t.height()-s-h-10;if(u>f&&(u=f,a.css({height:"100%","padding-bottom":0})),i.height(u),n.height(c.height()-d.height()-33-m),r.height(c.height()-35-m),$(".chat-room__bd4").height(c.height()-35-m-41),3!=o){var _=$(".chat-room__bd"+o).find(".chat-roomOther__scroll");_.data("jsp")&&_.data("jsp").reinitialise()}}}(),c=!1,s={init:function(){this.bindEvent(),this.noLiveSwitch()},bindEvent:function(){var t=$(".chat-room__tab"),e=$("#tipsOrchat"),i=$(".current-peo-foot").find("span");t.click(function(){if(o=$(this).attr("tab_index"),$(this).hasClass("current"))return!1;if($(this).addClass("current").siblings(".chat-room__tab").removeClass("current"),$(".chat-room__bd"+o).css({visibility:"visible"}).siblings(".chat-room__bd").css({visibility:"hidden"}),3==o)e.show();else{e.hide();var t=$(".chat-room__bd"+o).find(".chat-roomOther__scroll");t.jScrollPane({scrollbarWidth:8,mouseWheelSpeed:20}),4!=o||c||(c=!0,t.on("jsp-scroll-y",function(t,e,o,n){n?i.show():i.hide()})),4==o&&liveListenObj.vipBarListReflesh(liveListenObj.vipBarList)}})},noLiveSwitch:function(){return 1==$(".chat-room__tab").length?($(".chat-room__tab").eq(0).trigger("click"),!1):"undefined"!=typeof window.liveRoomConfig.isNotLive&&1==window.liveRoomConfig.isNotLive&&1==$(".chat-room__bd2").length&&2==$(".chat-room__tab").length?(setTimeout(function(){$(".chat-room__tab").eq(1).trigger("click")},0),!1):"undefined"!=typeof REPLAY&&1==REPLAY&&1==$(".chat-room__bd2").length&&2==$(".chat-room__tab").length?(setTimeout(function(){$(".chat-room__tab").eq(1).trigger("click")},0),!1):void 0}};$(function(){DUYA_SUB.subscribe("resizeWide",function(){r()}),r(),s.init()})});